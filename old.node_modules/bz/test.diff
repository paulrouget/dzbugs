diff --git a/lib/bz.js b/lib/bz.js
index 26d2342..c943630 100644
--- a/lib/bz.js
+++ b/lib/bz.js
@@ -1,5 +1,3 @@
-var sys = require("sys");
-
 var BugzillaClient = function(options) {
   options = options || {};
   this.username = options.username;
@@ -74,8 +72,6 @@ BugzillaClient.prototype = {
   },
 
   APIRequest : function(path, method, callback, field, body, params) {
-  //  sys.puts("path: " + path + " method: " + method 
-    //  + " callback " + typeof callback + " data " + JSON.stringify(body));
     var url = this.apiUrl + path;
     if(this.username && this.password) {
       params = params || {};
@@ -86,6 +82,11 @@ BugzillaClient.prototype = {
       url += "?" + this.urlEncode(params);
     body = JSON.stringify(body);
     
+    try {
+      XMLHttpRequest = require("xhr").XMLHttpRequest; // Addon SDK
+    }
+    catch(e) {}
+
     var that = this;
     if(typeof XMLHttpRequest != "undefined") {
       // in a browser
@@ -93,45 +94,28 @@ BugzillaClient.prototype = {
       req.open(method, url, true);
       req.setRequestHeader("Accept", "application/json")
       req.setRequestHeader("Content-type", "application/json");
-      req.addEventListener("load", function () {
-        that.handleResponse(null, req, callback, field);
-      }, false);
-
+      req.onreadystatechange = function (event) {
+        if (req.readyState == 4) {
+          that.handleResponse(null, req, callback, field);
+        } 
+      };
       req.send(body);
     }
     else {
-      var request = require('request');
-      if(request.Request) {
-        // Mozilla Addon SDK
-        var req = Request({
-          url: url,
-          contentType: 'application/json',
-          onComplete: function (response) {
-            that.handleResponse(null, {
-                status: response.status,
-                responseText: response.text,
-              }, callback, field);
-          }
-        });
-
-        req[method.toLowerCase()]();
-      }
-      else {
-        // node 'request' package
-        request({
-            uri: url,
-            method: method,
-            body: body,
-            headers: {'Content-type': 'application/json'}
-          },
-          function (err, resp, body) {
-            that.handleResponse(err, {
-                status: resp && resp.statusCode,
-                responseText: body
-              }, callback, field);
-          }
-        );
-      }
+      // node 'request' package
+      request({
+          uri: url,
+          method: method,
+          body: body,
+          headers: {'Content-type': 'application/json'}
+        },
+        function (err, resp, body) {
+          that.handleResponse(err, {
+              status: resp && resp.statusCode,
+              responseText: body
+            }, callback, field);
+        }
+      );
     }
   },
   
